(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{283:function(a,n,e){a.exports=e.p+"assets/img/canva2scale2.c56c36e7.png"},284:function(a,n,e){a.exports=e.p+"assets/img/canva2scale1.fad692c4.png"},285:function(a,n,e){a.exports=e.p+"assets/img/canva1scale1.e51c0d4e.png"},286:function(a,n,e){a.exports=e.p+"assets/img/canva1scale2.e9bb83bb.png"},318:function(a,n,e){"use strict";e.r(n);var t=e(14),s=Object(t.a)({},(function(){var a=this,n=a._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h2",{attrs:{id:"html2canvas-踩坑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#html2canvas-踩坑"}},[a._v("#")]),a._v(" html2canvas 踩坑")]),a._v(" "),n("hr"),a._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/7121631173549228069",target:"_blank",rel:"noopener noreferrer"}},[a._v("html2canvas.js实现html生成图片-稀土掘金"),n("OutboundLink")],1)]),a._v(" "),n("h2",{attrs:{id:"代码实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码实现"}},[a._v("#")]),a._v(" 代码实现")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("  import html2canvas from 'html2canvas';\n\n   // dom元素转为图片\n  const handleDomToImg = async () => {\n    // 获取dom元素\n    const graphImg = document.getElementById('htmlToImgBox');\n    // 创建canvas元素\n    const canvasdom = document.createElement('canvas');\n\n    // 获取dom宽高\n    const w = parseInt(window.getComputedStyle(graphImg).width, 10);\n    const h = parseInt(window.getComputedStyle(graphImg).height, 10);\n    \n    // 设定 canvas 元素属性宽高为 DOM 节点宽高 * 像素比 \n    const scaleBy = 2; //也可以用window.devicePixelRatio，\n    canvasdom.width = width * scaleBy; \n    canvasdom.height = height * scaleBy;\n    \n    //scale:2 按比例增加分辨率，将绘制内容放大对应比例\n    const canvas = await html2canvas(graphImg, { canvas: canvasdom, scale: scaleBy,useCORS:true });\n    \n    //将canvas转为base64\n    const url = canvas.toDataURL();\n    \n    //配置下载的文件名\n    const fileName = `下载报告${new Date().valueOf()}`;\n    downloadFile(url, fileName);\n  };\n\n  const downloadFile = (href, fileName = '报告') => {\n    const downloadElement = document.createElement('a');\n    downloadElement.href = href;\n    downloadElement.download = `${fileName}.png`;\n    document.body.appendChild(downloadElement);\n    downloadElement.click();\n    document.body.removeChild(downloadElement);\n    window.URL.revokeObjectURL(href);\n  };\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("<div className={style.preview} id=\"htmlToImgBox\">\n    <div className={style['preview-title']}>\n    <span>测试学校</span>\n    <span>学习笔记完成情况</span>\n    </div>\n    <div className={style['preview-sub-title']}>\n    <span>2022-12-12 18:00:00</span>\n    <span>高一年级</span>\n    </div>\n    <div className={style['preview-content']}>\n    <div className={classnames(style['preview-card'], style.blue)}>\n        <div>笔记上传数</div>\n        <div>\n        共计\n        <span className={style['preview-num']}>3000</span>\n        份\n        </div>\n    </div>\n    <div className={classnames(style['preview-card'], style.orange)}>\n        <div>优秀笔记上传数 </div>\n        <div>\n        共计\n        <span className={style['preview-num']}>1002</span>\n        份\n        </div>\n    </div>\n    <div className={classnames(style['preview-card'], style.zise)}>\n        <div>参与人数</div>\n        <div>\n        共计\n        <span className={style['preview-num']}>3002</span>\n        人\n        </div>\n    </div>\n    <div className={classnames(style['preview-card'], style.red)}>\n        <div>参与人数占比</div>\n        <div>\n        <span className={style['preview-num']}>37</span>\n        %\n        </div>\n    </div>\n    </div>\n    <div className={style['preview-footer']}>\n    学习笔记有助于帮助学生养成良好的学习习惯，促进对内容的理解，加强记忆知识点\n    </div>\n</div>\n")])])]),n("h2",{attrs:{id:"生成倍图"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生成倍图"}},[a._v("#")]),a._v(" 生成倍图")]),a._v(" "),n("p",[n("code",[a._v("canvasdom.width")]),a._v(" 以及 "),n("code",[a._v("html2canvas")]),a._v(" 的 "),n("code",[a._v("scale")]),a._v(" 配置")]),a._v(" "),n("ol",[n("li",[n("p",[a._v("canvasdom.width=2*w 、scale=2\n")]),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{width:"100%",src:e(283),alt:""}})]),n("p")]),a._v(" "),n("li",[n("p",[a._v("canvasdom.width=2*w 、scale=1\n")]),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{width:"100%",src:e(284),alt:""}})]),n("p")]),a._v(" "),n("li",[n("p",[a._v("canvasdom.width=1*w 、scale=1\n")]),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{width:"100%",src:e(285),alt:""}})]),n("p")]),a._v(" "),n("li",[n("p",[a._v("canvasdom.width=1*w 、scale=2\n")]),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{width:"100%",src:e(286),alt:""}})]),n("p")])]),a._v(" "),n("h2",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[a._v("#")]),a._v(" 总结：")]),a._v(" "),n("p",[n("strong",[a._v("canvasdom.width影响最终生成的图片的尺寸，scale配置项代表将绘制内容放大对应比例，如果需要生成2倍图，则需要同时将两个地方设置为2。")])]),a._v(" "),n("h2",{attrs:{id:"图片清晰度优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#图片清晰度优化"}},[a._v("#")]),a._v(" 图片清晰度优化")]),a._v(" "),n("ol",[n("li",[a._v("canvas.width和canvas.style.width")])]),a._v(" "),n("ul",[n("li",[a._v("canvas.width / canvas.height 表示画布真实大小，我们并不可见")]),a._v(" "),n("li",[a._v("canvas.style.width / canvas.style.height 表示画布输出到浏览器我们最终可见的的大小")]),a._v(" "),n("li",[a._v("不提供canvas真实大小时，默认按300*150处理，如果指定canvas.width / canvas.height,没有指定canvas.style，则两者相同")]),a._v(" "),n("li",[a._v("canvas绘制的时候先是参考自己本身画布大小进行绘制，绘制完毕，由style指定的大小，渲染在浏览器页面上。")])]),a._v(" "),n("p",[a._v("canvas.width和canvas.style.width也是影响图片模糊的关键")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v(' <canvas id="diagonal" style="border:1px solid;width:200px;height:200px;" width="100px" height="100px">\n \n function drawDiagonal(id) {\n      var canvas = document.getElementById(id);\n      var context = canvas.getContext("2d");\n      context.beginPath();\n      context.moveTo(0, 0);\n      context.lineTo(100, 100);\n      context.stroke();\n }\n\nwindow.onload = function() {\n   drawDiagonal("diagonal");\n}\n')])])]),n("p",[n("strong",[a._v("将canvas的属性width和height属性放大为2倍（或者设置为devicePixelRatio倍），最后将canvas的CSS样式width和height设置为原先1倍的大小，可以达到提高清晰度的目的。")])]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('convert2canvas() {\n    var shareContent = YourTargetElem; \n    var width = shareContent.offsetWidth; \n    var height = shareContent.offsetHeight; \n    var canvas = document.createElement("canvas"); \n    var scale = 2; \n\n    canvas.width = width * scale; \n    canvas.height = height * scale; \n    canvas.getContext("2d").scale(scale, scale); \n\n    var opts = {\n        scale: scale, \n        canvas: canvas, \n        logging: true, \n        width: width, \n        height: height \n    };\n    html2canvas(shareContent, opts).then(function (canvas) {\n        var context = canvas.getContext(\'2d\');\n        var img = Canvas2Image.convertToImage(canvas, canvas.width, canvas.height);\n        document.body.appendChild(img);\n        $(img).css({ \n            "width": canvas.width / 2 + "px", //缩小图片尺寸\n            "height": canvas.height / 2 + "px",\n        })\n    });\n}\n')])])]),a._v(" "),n("comment-comment")],1)}),[],!1,null,null,null);n.default=s.exports}}]);