### 实现一个简单的富文本编辑器
---

#### 一、在 HTML 文档中实现富文本编辑器

#### 方式一： iframe
通过设置属性designMode为on来使文档可编辑，但只有当文档完全加载后才可以设置。

```
<iframe name="editor" style="width: 600px; height: 400px"></iframe>

<script>

    window.addEventListener('load', () => {

        frames['editor'].document.designMode = 'on'

    })

</script>
```


#### 方式二：contenteditable
通过给元素本身设置contenteditable属性为true或者空字符串，可以使元素立刻可编辑。

```
<div class="editor" id="editor" contenteditable="true"></div>
```

元素包含的任何文本都会被自动编辑，元素本身类似于textarea元素，也可以随时使元素切换元素的可编辑状态。

```
<div class="editorBox" id="editorBox"></div>

let editBox = document.getElementById('editorBox')

editBox.contentEditable = 'true'

```

#### 二、与富文本交互
iframe:
```
// 在内嵌窗格中切换粗体文本样式
frames["editor"].document.execCommand("bold", false, null);
// 在内嵌窗格中切换斜体文本样式
frames["editor"].document.execCommand("italic", false, null);
// 在内嵌窗格中创建指向www.wrox.com 的链接
frames["editor"].document.execCommand("createlink", false, "http://www.wrox.com");
// 在内嵌窗格中为内容添加<h1>标签
frames["editor"].document.execCommand("formatblock", false, "<h1>");
```
contenteditable:
```
// 切换粗体文本样式
document.execCommand("bold", false, null);
// 切换斜体文本样式
document.execCommand("italic", false, null);
// 创建指向www.wrox.com 的链接
document.execCommand("createlink", false, "http://www.wrox.com");
// 为内容添加<h1>标签
document.execCommand("formatblock", false, "<h1>");
```

#### 富文件选区
通过getSelection() 方法获取文本选区
```
// 使用 Selection 对象实现选中文本高亮，经测试发现此方法在iframe的方式内不生效。

function highlight() {

    // 取得表示选区的范围
    let selection = document.getSelection();
    
    // 高亮选中的文本
    let range = selection.getRangeAt(0);
   
    // 给选中文本添加背景为黄色的<span>标签
    let span = document.createElement("span");
    span.style.backgroundColor = "yellow";
    
    range.surroundContents(span);

}
```

#### 通过表单提交富文本
因为富文本编辑不是在表单控件中实现，这意味着要将富文本编辑结果提交给服务器，就要手动进行。我们会在表单中添加一个 type="hidden" 的字段，在提交表单时，通过监听器，从元素中提取出 HTML 并插入隐藏字段中。

iframe:
```
// form 实例是`<form>` 元素，可以使用DOM获取

form.addEventListener("submit", (event) => {

    let target = event.target;

    target.elements["content"].value = frames["editor"].document.body.innerHTML;

});

```

contenteditable:
```
// form 实例是`<form>` 元素，可以使用DOM获取

form.addEventListener("submit", (event) => {

    let target = event.target;

    target.elements["content"].value = document.getElementsByClassName("editor")[0].innerHTML;

});

```